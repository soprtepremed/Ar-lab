<!-- Modal Escanear QR -->
<div id="modalEscanearQR" class="modal-overlay">
    <div class="modal" style="max-width: 500px;">
        <div class="modal-header"
            style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border-radius: 20px 20px 0 0; padding: 1.5rem;">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div
                    style="width: 48px; height: 48px; background: rgba(255,255,255,0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                    <svg viewBox="0 0 24 24" width="28" height="28" stroke="currentColor" fill="none"
                        stroke-width="2.5">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="9" y1="9" x2="9" y2="15"></line>
                        <line x1="15" y1="9" x2="15" y2="15"></line>
                    </svg>
                </div>
                <h3 style="margin: 0; font-size: 1.25rem;">ESCANEAR CÓDIGO QR</h3>
            </div>
            <button class="modal-close" onclick="cerrarModalEscanearQR()" style="color: white; opacity: 0.9;">
                <svg viewBox="0 0 24 24">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="modal-body" style="padding: 1.5rem;">
            <p style="color: #64748b; text-align: center; margin-bottom: 1rem; font-size: 0.9rem;">
                <strong style="color: #1e293b;">Instrucciones:</strong><br>
                Coloca el código QR del ticket dentro del recuadro verde
            </p>

            <div
                style="position: relative; width: 100%; max-width: 350px; margin: 0 auto; background: #000; border-radius: 12px; overflow: hidden;">
                <video id="qrVideo" style="width: 100%; display: block; border-radius: 12px;" autoplay
                    playsinline></video>
                <canvas id="qrCanvas" style="display: none;"></canvas>

                <!-- QR Scanning Frame Overlay -->
                <div
                    style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 220px; height: 220px; border: 3px solid #10b981; border-radius: 16px; box-shadow: 0 0 0 9999px rgba(0,0,0,0.5); pointer-events: none;">
                    <!-- Corner decorations -->
                    <div
                        style="position: absolute; top: -3px; left: -3px; width: 30px; height: 30px; border-top: 4px solid #10b981; border-left: 4px solid #10b981; border-radius: 4px 0 0 0;">
                    </div>
                    <div
                        style="position: absolute; top: -3px; right: -3px; width: 30px; height: 30px; border-top: 4px solid #10b981; border-right: 4px solid #10b981; border-radius: 0 4px 0 0;">
                    </div>
                    <div
                        style="position: absolute; bottom: -3px; left: -3px; width: 30px; height: 30px; border-bottom: 4px solid #10b981; border-left: 4px solid #10b981; border-radius: 0 0 0 4px;">
                    </div>
                    <div
                        style="position: absolute; bottom: -3px; right: -3px; width: 30px; height: 30px; border-bottom: 4px solid #10b981; border-right: 4px solid #10b981; border-radius: 0 0 4px 0;">
                    </div>
                </div>

                <!-- Scanning animation line -->
                <div
                    style="position: absolute; top: calc(50% - 110px); left: 50%; transform: translateX(-50%); width: 220px; height: 2px; background: linear-gradient(90deg, transparent, #10b981, transparent); animation: scanLine 2s linear infinite;">
                </div>
            </div>

            <div
                style="margin-top: 1.5rem; padding: 1rem; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                <p
                    style="margin: 0; color: #1e40af; font-size: 0.85rem; display: flex; align-items: center; gap: 0.5rem;">
                    <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" fill="none" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    <span>El QR se detectará automáticamente</span>
                </p>
            </div>

            <button onclick="cerrarModalEscanearQR()" class="btn btn-secondary"
                style="width: 100%; margin-top: 1rem; justify-content: center;">Cancelar</button>
        </div>
    </div>
</div>

<style>
    @keyframes scanLine {
        0% {
            top: calc(50% - 110px);
        }

        50% {
            top: calc(50% + 110px);
        }

        100% {
            top: calc(50% - 110px);
        }
    }
</style>

<!-- INSERTA ESTE CÓDIGO EN dashboard.html DESPUÉS DEL MODAL DE VERIFICAR ASISTENCIA (Línea 2744) -->